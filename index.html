<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MeteorShower - Bot de Liquidit√© DLMM</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <h1>üåü MeteorShower</h1>
                    <span class="subtitle">Bot de Liquidit√© DLMM</span>
                </div>
                <div class="wallet-section">
                    <button id="connectWallet" class="wallet-btn" style="display: none;">
                        <span class="wallet-icon">üëõ</span>
                        Connecter Wallet
                    </button>
                    <div class="wallet-controls">
                        <button id="createWallet" class="btn btn-primary">
                            <span class="btn-icon">‚ûï</span>
                            Cr√©er Wallet
                        </button>
                        <button id="importWallet" class="btn btn-secondary">
                            <span class="btn-icon">üì•</span>
                            Importer Wallet
                        </button>
                    </div>
                    <div id="walletInfo" class="wallet-info hidden">
                        <div class="wallet-address"></div>
                        <div class="wallet-balance"></div>
                        <div class="wallet-actions">
                            <button id="exportWallet" class="btn-small">Exporter</button>
                            <button id="disconnectWallet" class="btn-small btn-danger">D√©connecter</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main">
            <!-- Wallet Creation Modal -->
            <div id="walletModal" class="modal hidden">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 id="modalTitle">Cr√©er un nouveau wallet</h2>
                        <button id="closeModal" class="close-btn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <!-- Create Wallet -->
                        <div id="createWalletForm" class="wallet-form">
                            <div class="form-group">
                                <label for="walletName">Nom du wallet</label>
                                <input type="text" id="walletName" placeholder="Mon Wallet DLMM" />
                            </div>
                            <div class="form-group">
                                <label for="walletPassword">Mot de passe (optionnel)</label>
                                <input type="password" id="walletPassword" placeholder="Mot de passe pour chiffrer le wallet" />
                            </div>
                            <div class="warning-box">
                                <div class="warning-icon">‚ö†Ô∏è</div>
                                <div class="warning-content">
                                    <strong>Important:</strong> Sauvegardez votre cl√© priv√©e en lieu s√ªr. 
                                    Sans elle, vous perdrez l'acc√®s √† vos fonds d√©finitivement.
                                </div>
                            </div>
                            <div class="modal-actions">
                                <button id="generateWallet" class="btn btn-primary">
                                    <span class="btn-icon">üîë</span>
                                    G√©n√©rer Wallet
                                </button>
                            </div>
                        </div>

                        <!-- Import Wallet -->
                        <div id="importWalletForm" class="wallet-form hidden">
                            <div class="form-group">
                                <label for="importMethod">M√©thode d'import</label>
                                <select id="importMethod">
                                    <option value="privateKey">Cl√© priv√©e</option>
                                    <option value="mnemonic">Phrase mn√©motechnique</option>
                                    <option value="keyfile">Fichier de cl√©s (.json)</option>
                                </select>
                            </div>
                            
                            <div id="privateKeyImport" class="import-method">
                                <div class="form-group">
                                    <label for="privateKeyInput">Cl√© priv√©e</label>
                                    <textarea id="privateKeyInput" placeholder="Collez votre cl√© priv√©e ici..." rows="3"></textarea>
                                </div>
                            </div>
                            
                            <div id="mnemonicImport" class="import-method hidden">
                                <div class="form-group">
                                    <label for="mnemonicInput">Phrase mn√©motechnique (12/24 mots)</label>
                                    <textarea id="mnemonicInput" placeholder="word1 word2 word3 ..." rows="3"></textarea>
                                </div>
                            </div>
                            
                            <div id="keyfileImport" class="import-method hidden">
                                <div class="form-group">
                                    <label for="keyfileInput">Fichier de cl√©s</label>
                                    <input type="file" id="keyfileInput" accept=".json" />
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="importWalletName">Nom du wallet</label>
                                <input type="text" id="importWalletName" placeholder="Nom pour ce wallet" />
                            </div>
                            
                            <div class="modal-actions">
                                <button id="importWalletBtn" class="btn btn-primary">
                                    <span class="btn-icon">üì•</span>
                                    Importer Wallet
                                </button>
                            </div>
                        </div>

                        <!-- Wallet Generated -->
                        <div id="walletGenerated" class="wallet-result hidden">
                            <div class="success-message">
                                <div class="success-icon">‚úÖ</div>
                                <h3>Wallet cr√©√© avec succ√®s!</h3>
                            </div>
                            
                            <div class="wallet-details">
                                <div class="detail-item">
                                    <label>Adresse publique:</label>
                                    <div class="address-display">
                                        <span id="generatedAddress"></span>
                                        <button id="copyAddress" class="copy-btn">üìã</button>
                                    </div>
                                </div>
                                
                                <div class="detail-item">
                                    <label>Cl√© priv√©e:</label>
                                    <div class="private-key-display">
                                        <textarea id="generatedPrivateKey" readonly rows="3"></textarea>
                                        <button id="copyPrivateKey" class="copy-btn">üìã</button>
                                        <button id="downloadWallet" class="btn btn-secondary">
                                            <span class="btn-icon">üíæ</span>
                                            T√©l√©charger .json
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="warning-box">
                                <div class="warning-icon">üîí</div>
                                <div class="warning-content">
                                    <strong>S√©curit√©:</strong> Copiez et sauvegardez votre cl√© priv√©e maintenant. 
                                    Cette fen√™tre ne s'affichera plus apr√®s fermeture.
                                </div>
                            </div>
                            
                            <div class="modal-actions">
                                <button id="useWallet" class="btn btn-primary">
                                    <span class="btn-icon">‚úÖ</span>
                                    Utiliser ce wallet
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Setup Steps -->
            <div class="setup-container">
                <div class="progress-bar">
                    <div class="progress-step active" data-step="1">
                        <div class="step-number">1</div>
                        <div class="step-label">Wallet</div>
                    </div>
                    <div class="progress-step" data-step="2">
                        <div class="step-number">2</div>
                        <div class="step-label">Configuration</div>
                    </div>
                    <div class="progress-step" data-step="3">
                        <div class="step-number">3</div>
                        <div class="step-label">Pool</div>
                    </div>
                    <div class="progress-step" data-step="4">
                        <div class="step-number">4</div>
                        <div class="step-label">Param√®tres</div>
                    </div>
                    <div class="progress-step" data-step="5">
                        <div class="step-number">5</div>
                        <div class="step-label">Lancement</div>
                    </div>
                </div>

                <!-- Step 1: Wallet Setup -->
                <div class="step-content active" data-step="1">
                    <div class="step-card">
                        <h2>üëõ Configuration du Wallet</h2>
                        <p>Configurez votre wallet et la connexion RPC pour commencer.</p>
                        
                        <!-- Wallet Status -->
                        <div class="wallet-status-section">
                            <h3>√âtat du Wallet</h3>
                            <div id="walletStatusDisplay" class="status-display">
                                <div class="status-item">
                                    <span class="status-icon">‚ùå</span>
                                    <span>Aucun wallet connect√©</span>
                                </div>
                            </div>
                            
                            <div id="walletDetails" class="wallet-details-section hidden">
                                <div class="detail-row">
                                    <span class="label">Adresse:</span>
                                    <span id="currentWalletAddress" class="value"></span>
                                    <button id="copyCurrentAddress" class="copy-btn">üìã</button>
                                </div>
                                <div class="detail-row">
                                    <span class="label">Balance:</span>
                                    <span id="currentWalletBalance" class="value">0.000 SOL</span>
                                    <button id="refreshBalance" class="refresh-btn">üîÑ</button>
                                </div>
                                <div class="detail-row">
                                    <span class="label">R√©seau:</span>
                                    <span id="currentNetwork" class="value">Mainnet</span>
                                </div>
                            </div>
                        </div>

                        <!-- RPC Configuration -->
                        <div class="form-group">
                            <label for="rpcUrl">Point de terminaison RPC</label>
                            <select id="rpcPresets">
                                <option value="">S√©lectionner un fournisseur...</option>
                                <option value="https://api.mainnet-beta.solana.com">Solana Public RPC (Gratuit)</option>
                                <option value="helius">Helius (Recommand√©)</option>
                                <option value="quicknode">QuickNode</option>
                                <option value="alchemy">Alchemy</option>
                                <option value="custom">URL personnalis√©e</option>
                            </select>
                            <input type="url" id="rpcUrl" placeholder="https://mainnet.helius-rpc.com/?api-key=your-key" class="hidden" />
                            <div class="input-help">
                                <span>üí° Recommand√©: <a href="https://helius.xyz" target="_blank">Helius</a> ou <a href="https://quicknode.com" target="_blank">QuickNode</a></span>
                            </div>
                        </div>

                        <div class="connection-status">
                            <div id="rpcStatus" class="status-item">
                                <span class="status-icon">‚è≥</span>
                                <span>Connexion RPC: Non test√©e</span>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button id="testConnection" class="btn btn-secondary">Tester la connexion</button>
                            <button id="nextStep1" class="btn btn-primary" disabled>Continuer</button>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Configuration -->
                <div class="step-content" data-step="2">
                    <div class="step-card">
                        <h2>‚öôÔ∏è Configuration de base</h2>
                        <p>Configurez les param√®tres de base du bot.</p>
                        
                        <div class="config-sections">
                            <!-- Capital Amount -->
                            <div class="config-section">
                                <h3>üí∞ Montant du capital</h3>
                                <div class="amount-selector">
                                    <div class="balance-info">
                                        <span>Disponible: <span id="availableBalance">0.000</span> SOL</span>
                                    </div>
                                    <div class="amount-input">
                                        <input type="number" id="solAmount" placeholder="0.1" step="0.001" min="0.001" />
                                        <span class="currency">SOL</span>
                                    </div>
                                    <div class="amount-presets">
                                        <button class="preset-btn" data-percent="25">25%</button>
                                        <button class="preset-btn" data-percent="50">50%</button>
                                        <button class="preset-btn" data-percent="75">75%</button>
                                        <button class="preset-btn" data-percent="100">Max</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Token Allocation -->
                            <div class="config-section">
                                <h3>‚öñÔ∏è Allocation des tokens</h3>
                                <div class="allocation-slider">
                                    <div class="slider-labels">
                                        <span id="tokenXLabel">100% SOL</span>
                                        <span id="tokenYLabel">0% USDC</span>
                                    </div>
                                    <input type="range" id="allocationSlider" min="0" max="100" value="50" />
                                    <div class="slider-marks">
                                        <span>100:0</span>
                                        <span>50:50</span>
                                        <span>0:100</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Bin Span -->
                            <div class="config-section">
                                <h3>üìä Plage de position</h3>
                                <div class="bin-span-selector">
                                    <div class="span-input">
                                        <label for="binSpan">Bin Span</label>
                                        <input type="number" id="binSpan" value="40" min="3" max="1400" />
                                    </div>
                                    <div class="coverage-info">
                                        <span>Price Coverage: <span id="priceCoverage">10.0%</span></span>
                                        <div class="coverage-help">
                                            Plus de bins = couverture plus large, liquidit√© moins concentr√©e
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Strategy -->
                            <div class="config-section">
                                <h3>‚ö° Strat√©gie de liquidit√©</h3>
                                <div class="strategy-selector">
                                    <div class="strategy-option active" data-strategy="Spot">
                                        <div class="strategy-name">Spot</div>
                                        <div class="strategy-desc">Distribution uniforme (paires volatiles)</div>
                                    </div>
                                    <div class="strategy-option" data-strategy="Curve">
                                        <div class="strategy-name">Curve</div>
                                        <div class="strategy-desc">Concentr√© autour du prix actuel</div>
                                    </div>
                                    <div class="strategy-option" data-strategy="BidAsk">
                                        <div class="strategy-name">BidAsk</div>
                                        <div class="strategy-desc">Strat√©gie de market making</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button id="prevStep2" class="btn btn-secondary">Retour</button>
                            <button id="nextStep2" class="btn btn-primary">Continuer</button>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Pool Selection -->
                <div class="step-content" data-step="3">
                    <div class="step-card">
                        <h2>üèä S√©lection du pool</h2>
                        <p>Choisissez le pool Meteora DLMM pour fournir de la liquidit√©.</p>
                        
                        <div class="pool-options">
                            <div class="pool-grid">
                                <div class="pool-card" data-pool="6wJ7W3oHj7ex6MVFp2o26NSof3aey7U8Brs8E371WCXA">
                                    <div class="pool-header">
                                        <div class="pool-tokens">
                                            <span class="token">SOL</span>
                                            <span class="separator">/</span>
                                            <span class="token">USDC</span>
                                        </div>
                                        <div class="pool-fee">25bp</div>
                                    </div>
                                    <div class="pool-stats">
                                        <div class="stat">
                                            <span class="label">TVL</span>
                                            <span class="value">$2.1M</span>
                                        </div>
                                        <div class="stat">
                                            <span class="label">Volume 24h</span>
                                            <span class="value">$450K</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="custom-pool">
                                <label for="customPool">Adresse de pool personnalis√©e</label>
                                <input type="text" id="customPool" placeholder="Entrez l'adresse du pool (43-44 caract√®res)" />
                                <div class="input-help">
                                    <span>Trouvez des pools sur <a href="https://app.meteora.ag/dlmm/" target="_blank">Meteora DLMM</a></span>
                                </div>
                            </div>
                        </div>

                        <div id="poolInfo" class="pool-info hidden">
                            <h3>Informations du pool</h3>
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="label">Token X:</span>
                                    <span class="value" id="tokenX">-</span>
                                </div>
                                <div class="info-item">
                                    <span class="label">Token Y:</span>
                                    <span class="value" id="tokenY">-</span>
                                </div>
                                <div class="info-item">
                                    <span class="label">Bin Step:</span>
                                    <span class="value" id="binStep">-</span>
                                </div>
                                <div class="info-item">
                                    <span class="label">Bin actif:</span>
                                    <span class="value" id="activeBin">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button id="prevStep3" class="btn btn-secondary">Retour</button>
                            <button id="nextStep3" class="btn btn-primary" disabled>Continuer</button>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Advanced Parameters -->
                <div class="step-content" data-step="4">
                    <div class="step-card">
                        <h2>üéØ Gestion des risques</h2>
                        <p>Configurez les conditions de sortie automatique et les fonctionnalit√©s avanc√©es.</p>
                        
                        <div class="risk-sections">
                            <!-- Take Profit / Stop Loss -->
                            <div class="config-section">
                                <h3>üìà Take Profit & Stop Loss</h3>
                                <div class="toggle-group">
                                    <div class="toggle-item">
                                        <label class="toggle">
                                            <input type="checkbox" id="takeProfitEnabled" />
                                            <span class="toggle-slider"></span>
                                        </label>
                                        <div class="toggle-content">
                                            <span class="toggle-label">Take Profit</span>
                                            <div class="toggle-input">
                                                <input type="number" id="takeProfitPercent" value="15" min="0.1" max="200" step="0.1" disabled />
                                                <span>%</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="toggle-item">
                                        <label class="toggle">
                                            <input type="checkbox" id="stopLossEnabled" />
                                            <span class="toggle-slider"></span>
                                        </label>
                                        <div class="toggle-content">
                                            <span class="toggle-label">Stop Loss</span>
                                            <div class="toggle-input">
                                                <input type="number" id="stopLossPercent" value="10" min="0.1" max="100" step="0.1" disabled />
                                                <span>%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Advanced Features -->
                            <div class="config-section">
                                <h3>üîß Fonctionnalit√©s avanc√©es</h3>
                                <div class="feature-toggles">
                                    <div class="feature-item">
                                        <label class="toggle">
                                            <input type="checkbox" id="swaplessRebalance" />
                                            <span class="toggle-slider"></span>
                                        </label>
                                        <div class="feature-content">
                                            <div class="feature-name">R√©√©quilibrage sans swap</div>
                                            <div class="feature-desc">Minimiser les frais avec des positions unilat√©rales</div>
                                            <div class="feature-config hidden" id="swaplessConfig">
                                                <label for="swaplessBinSpan">Swapless Bin Span:</label>
                                                <input type="number" id="swaplessBinSpan" value="15" min="3" max="1399" />
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="feature-item">
                                        <label class="toggle">
                                            <input type="checkbox" id="autoCompound" />
                                            <span class="toggle-slider"></span>
                                        </label>
                                        <div class="feature-content">
                                            <div class="feature-name">Composition automatique</div>
                                            <div class="feature-desc">R√©investir automatiquement les frais gagn√©s</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Monitoring Settings -->
                            <div class="config-section">
                                <h3>‚è±Ô∏è Param√®tres de surveillance</h3>
                                <div class="monitoring-config">
                                    <div class="form-group">
                                        <label for="monitorInterval">Intervalle de v√©rification (secondes)</label>
                                        <input type="number" id="monitorInterval" value="60" min="5" max="3600" />
                                    </div>
                                    <div class="form-group">
                                        <label for="priorityFee">Frais de priorit√© (micro-lamports)</label>
                                        <input type="number" id="priorityFee" value="50000" min="1000" max="1000000" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button id="prevStep4" class="btn btn-secondary">Retour</button>
                            <button id="nextStep4" class="btn btn-primary">Continuer</button>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Launch -->
                <div class="step-content" data-step="5">
                    <div class="step-card">
                        <h2>üöÄ Lancer le bot</h2>
                        <p>V√©rifiez votre configuration et d√©marrez le bot de liquidit√©.</p>
                        
                        <div class="config-summary">
                            <h3>R√©sum√© de la configuration</h3>
                            <div class="summary-grid">
                                <div class="summary-item">
                                    <span class="label">Pool:</span>
                                    <span class="value" id="summaryPool">-</span>
                                </div>
                                <div class="summary-item">
                                    <span class="label">Capital:</span>
                                    <span class="value" id="summaryCapital">-</span>
                                </div>
                                <div class="summary-item">
                                    <span class="label">Allocation:</span>
                                    <span class="value" id="summaryAllocation">-</span>
                                </div>
                                <div class="summary-item">
                                    <span class="label">Bin Span:</span>
                                    <span class="value" id="summaryBinSpan">-</span>
                                </div>
                                <div class="summary-item">
                                    <span class="label">Strategy:</span>
                                    <span class="value" id="summaryStrategy">-</span>
                                </div>
                                <div class="summary-item">
                                    <span class="label">Take Profit:</span>
                                    <span class="value" id="summaryTakeProfit">-</span>
                                </div>
                                <div class="summary-item">
                                    <span class="label">Stop Loss:</span>
                                    <span class="value" id="summaryStopLoss">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="launch-section">
                            <div class="warning-box">
                                <div class="warning-icon">‚ö†Ô∏è</div>
                                <div class="warning-content">
                                    <strong>Important:</strong> Ce bot g√©rera automatiquement votre position de liquidit√©. 
                                    Assurez-vous de comprendre les risques li√©s √† la fourniture de liquidit√© et au trading automatis√©.
                                </div>
                            </div>
                            
                            <div class="launch-actions">
                                <button id="prevStep5" class="btn btn-secondary">Retour</button>
                                <button id="launchBot" class="btn btn-primary btn-large">
                                    <span class="btn-icon">üöÄ</span>
                                    Lancer le bot
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bot Running Status -->
                <div class="step-content" data-step="running">
                    <div class="step-card">
                        <h2>ü§ñ Bot en cours d'ex√©cution</h2>
                        <p>Votre bot de liquidit√© est maintenant actif et surveille votre position.</p>
                        
                        <div class="bot-status">
                            <div class="status-header">
                                <div class="status-indicator running"></div>
                                <span>√âtat du bot: En cours d'ex√©cution</span>
                            </div>
                            
                            <div class="performance-metrics">
                                <div class="metric">
                                    <div class="metric-label">Valeur de la position</div>
                                    <div class="metric-value" id="positionValue">$0.00</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-label">P&L</div>
                                    <div class="metric-value" id="pnlValue">+$0.00 (0.0%)</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-label">Frais gagn√©s</div>
                                    <div class="metric-value" id="feesEarned">$0.00</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-label">R√©√©quilibrages</div>
                                    <div class="metric-value" id="rebalanceCount">0</div>
                                </div>
                            </div>
                            
                            <div class="bot-actions">
                                <button id="pauseBot" class="btn btn-secondary">Mettre en pause</button>
                                <button id="stopBot" class="btn btn-danger">Arr√™ter et fermer la position</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-spinner"></div>
        <div class="loading-text">Chargement...</div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="https://unpkg.com/tweetnacl@latest/nacl-fast.min.js"></script>
    <script src="https://unpkg.com/bs58@latest/index.js"></script>
    <script src="script.js"></script>
</body>
</html>